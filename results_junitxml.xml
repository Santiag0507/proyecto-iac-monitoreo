<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="52" tests="112" time="0.0">
	<testsuite disabled="0" errors="0" failures="52" name="terraform scan" skipped="0" tests="112" time="0">
		<properties>
			<property name="directory" value="['/app']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results1.xml~"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/app"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/main.tf.aws_iam_role.lambda_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/main.tf.aws_iam_role.lambda_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/main.tf.aws_iam_role.lambda_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/main.tf.aws_iam_role_policy_attachment.lambda_logs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/main.tf.aws_dynamodb_table.iot_data" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="/main.tf.aws_lambda_permission.allow_apigw_send_to_sqs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/main.tf.aws_lambda_permission.allow_apigw_send_to_sqs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="/main.tf.aws_lambda_permission.allow_apigw" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/main.tf.aws_lambda_permission.allow_apigw" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/main.tf.aws_cloudwatch_log_group.lambda_logs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/main.tf.aws_cloudwatch_log_group.lambda_send_to_sqs_logs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_168] Ensure SQS queue policy is not public by only allowing specific services or principals to access it" classname="/main.tf.aws_sqs_queue.iot_alert_queue" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/main.tf.aws.default" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_358] Ensure AWS GitHub Actions OIDC authorization policies only allow safe claims and claim order" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_111] Ensure IAM policies does not allow write access without constraints" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_283] Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_108] Ensure IAM policies does not allow data exfiltration" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_49] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_110] Ensure IAM policies does not allow privilege escalation" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_109] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_356] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_1] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_107] Ensure IAM policies does not allow credentials exposure" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_77] Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/main.tf.aws_apigatewayv2_api.http_api" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/main.tf.aws_iam_role.lambda_role" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/main.tf.aws_iam_role_policy_attachment.lambda_logs" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_73] Ensure AWS SQS uses CMK not AWS default keys for encryption" classname="/main.tf.aws_sqs_queue.iot_alert_queue" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/main.tf.aws_iam_policy_document.lambda_assume_role" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/main.tf.aws_iam_role_policy.lambda_dynamodb" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/main.tf.aws_dynamodb_table.iot_data" file="/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_51] Ensure AWS API Gateway endpoints uses client certificate authentication" classname="/main.tf.aws_apigatewayv2_stage.default_stage" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/main.tf.aws_dynamodb_table.iot_data" file="/main.tf">
			<failure type="failure" message="Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK">
Resource: aws_dynamodb_table.iot_data
File: /main.tf: 64-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52

		64 | resource &quot;aws_dynamodb_table&quot; &quot;iot_data&quot; {
		65 |   name         = &quot;IoTDataTable&quot;
		66 |   billing_mode = &quot;PAY_PER_REQUEST&quot;
		67 |   hash_key     = &quot;device_id&quot;
		68 | 
		69 |   attribute {
		70 |     name = &quot;device_id&quot;
		71 |     type = &quot;S&quot;
		72 |   }
		73 | 
		74 |   point_in_time_recovery {
		75 |     enabled = true
		76 |   } 
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.lambdas[&quot;alert_system&quot;]" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.lambdas[&quot;alert_system&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_309] Ensure API GatewayV2 routes specify an authorization type" classname="/main.tf.aws_apigatewayv2_route.send_to_sqs_route" file="/main.tf">
			<failure type="failure" message="Ensure API GatewayV2 routes specify an authorization type">
Resource: aws_apigatewayv2_route.send_to_sqs_route
File: /main.tf: 121-125
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-309

		121 | resource &quot;aws_apigatewayv2_route&quot; &quot;send_to_sqs_route&quot; {
		122 |   api_id    = aws_apigatewayv2_api.http_api.id
		123 |   route_key = &quot;POST /send_to_sqs&quot;
		124 |   target    = &quot;integrations/${aws_apigatewayv2_integration.send_to_sqs_integration.id}&quot;
		125 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_309] Ensure API GatewayV2 routes specify an authorization type" classname="/main.tf.aws_apigatewayv2_route.lambda_routes" file="/main.tf">
			<failure type="failure" message="Ensure API GatewayV2 routes specify an authorization type">
Resource: aws_apigatewayv2_route.lambda_routes
File: /main.tf: 144-149
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-309

		144 | resource &quot;aws_apigatewayv2_route&quot; &quot;lambda_routes&quot; {
		145 |   for_each  = aws_apigatewayv2_integration.lambda_integration
		146 |   api_id    = aws_apigatewayv2_api.http_api.id
		147 |   route_key = &quot;POST /${each.key}&quot;
		148 |   target    = &quot;integrations/${each.value.id}&quot;
		149 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="/main.tf.aws_apigatewayv2_stage.default_stage" file="/main.tf">
			<failure type="failure" message="Ensure API Gateway has Access Logging enabled">
Resource: aws_apigatewayv2_stage.default_stage
File: /main.tf: 151-155
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17

		151 | resource &quot;aws_apigatewayv2_stage&quot; &quot;default_stage&quot; {
		152 |   api_id      = aws_apigatewayv2_api.http_api.id
		153 |   name        = &quot;$default&quot;
		154 |   auto_deploy = true
		155 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/main.tf.aws_cloudwatch_log_group.lambda_logs" file="/main.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.lambda_logs
File: /main.tf: 168-172
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		168 | resource &quot;aws_cloudwatch_log_group&quot; &quot;lambda_logs&quot; {
		169 |   for_each          = aws_lambda_function.lambdas
		170 |   name              = &quot;/aws/lambda/${each.value.function_name}&quot;
		171 |   retention_in_days = 7
		172 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/main.tf.aws_cloudwatch_log_group.lambda_logs" file="/main.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.lambda_logs
File: /main.tf: 168-172
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		168 | resource &quot;aws_cloudwatch_log_group&quot; &quot;lambda_logs&quot; {
		169 |   for_each          = aws_lambda_function.lambdas
		170 |   name              = &quot;/aws/lambda/${each.value.function_name}&quot;
		171 |   retention_in_days = 7
		172 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/main.tf.aws_cloudwatch_log_group.lambda_send_to_sqs_logs" file="/main.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: aws_cloudwatch_log_group.lambda_send_to_sqs_logs
File: /main.tf: 174-177
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		174 | resource &quot;aws_cloudwatch_log_group&quot; &quot;lambda_send_to_sqs_logs&quot; {
		175 |   name              = &quot;/aws/lambda/${aws_lambda_function.send_to_sqs.function_name}&quot;
		176 |   retention_in_days = 7
		177 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/main.tf.aws_cloudwatch_log_group.lambda_send_to_sqs_logs" file="/main.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.lambda_send_to_sqs_logs
File: /main.tf: 174-177
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		174 | resource &quot;aws_cloudwatch_log_group&quot; &quot;lambda_send_to_sqs_logs&quot; {
		175 |   name              = &quot;/aws/lambda/${aws_lambda_function.send_to_sqs.function_name}&quot;
		176 |   retention_in_days = 7
		177 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_27] Ensure all data stored in the SQS queue is encrypted" classname="/main.tf.aws_sqs_queue.iot_alert_queue" file="/main.tf">
			<failure type="failure" message="Ensure all data stored in the SQS queue is encrypted">
Resource: aws_sqs_queue.iot_alert_queue
File: /main.tf: 181-185
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue

		181 | resource &quot;aws_sqs_queue&quot; &quot;iot_alert_queue&quot; {
		182 |   name                      = &quot;iot_alert_queue&quot;
		183 |   visibility_timeout_seconds = 30
		184 |   message_retention_seconds = 86400  # 1 día
		185 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.send_to_sqs" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.send_to_sqs
File: /main.tf: 188-201
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		188 | resource &quot;aws_lambda_function&quot; &quot;send_to_sqs&quot; {
		189 |   function_name = &quot;send_to_sqs&quot;
		190 |   handler       = &quot;index.handler&quot;
		191 |   runtime       = &quot;nodejs18.x&quot;
		192 |   filename      = &quot;${path.module}/lambda_send_to_sqs.zip&quot;
		193 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_send_to_sqs.zip&quot;)
		194 |   role          = aws_iam_role.lambda_role.arn
		195 | 
		196 |   environment {
		197 |     variables = {
		198 |       SQS_URL = aws_sqs_queue.iot_alert_queue.id
		199 |     }
		200 |   }
		201 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/main.tf.aws_sns_topic.iot_alert_topic" file="/main.tf">
			<failure type="failure" message="Ensure all data stored in the SNS topic is encrypted">
Resource: aws_sns_topic.iot_alert_topic
File: /main.tf: 205-207
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15

		205 | resource &quot;aws_sns_topic&quot; &quot;iot_alert_topic&quot; {
		206 |   name = &quot;iot_alert_topic&quot;
		207 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.sqs_to_sns" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.sqs_to_sns
File: /main.tf: 218-231
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		218 | resource &quot;aws_lambda_function&quot; &quot;sqs_to_sns&quot; {
		219 |   function_name = &quot;sqs_to_sns&quot;
		220 |   handler       = &quot;index.handler&quot;
		221 |   runtime       = &quot;nodejs18.x&quot;
		222 |   filename      = &quot;${path.module}/lambda_sqs_to_sns.zip&quot;
		223 |   source_code_hash = filebase64sha256(&quot;${path.module}/lambda_sqs_to_sns.zip&quot;)
		224 |   role          = aws_iam_role.lambda_role.arn
		225 | 
		226 |   environment {
		227 |     variables = {
		228 |       SNS_TOPIC_ARN = aws_sns_topic.iot_alert_topic.arn
		229 |     }
		230 |   }
		231 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.lambdas[&quot;generate_report&quot;]" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.lambdas[&quot;generate_report&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.lambdas[&quot;get_dashboard&quot;]" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.lambdas[&quot;get_dashboard&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.lambdas[&quot;register_device&quot;]" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.lambdas[&quot;register_device&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/main.tf.aws_lambda_function.lambdas[&quot;store_metrics&quot;]" file="/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.lambdas[&quot;store_metrics&quot;]
File: /main.tf: 90-104
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		90  | resource &quot;aws_lambda_function&quot; &quot;lambdas&quot; {
		91  |   for_each         = local.lambdas
		92  |   function_name    = each.key
		93  |   filename         = &quot;${path.module}/${each.value}&quot;
		94  |   handler          = &quot;index.handler&quot;
		95  |   runtime          = &quot;nodejs18.x&quot;
		96  |   role             = aws_iam_role.lambda_role.arn
		97  |   source_code_hash = filebase64sha256(&quot;${path.module}/${each.value}&quot;)
		98  | 
		99  |   environment {
		100 |     variables = {
		101 |       DYNAMO_TABLE = aws_dynamodb_table.iot_data.name
		102 |     }
		103 |   }
		104 | }
</failure>
		</testcase>
	</testsuite>
</testsuites>
